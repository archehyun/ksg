<?xml version="1.0" encoding="UTF-8" ?>
<!--
    Copyright (c) 2010 IBM Corporation and others.
    All rights reserved. This program and the accompanying materials
    are made available under the terms of the Eclipse Public License v1.0
    which accompanies this distribution, and is available at
    http://www.eclipse.org/legal/epl-v10.html
   
    Contributors:
        IBM Corporation - initial API and implementation
 -->

<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="code">

	<resultMap id="codeList" class="com.ksg.domain.Code">
		<result property="code_field" column="CD_ID"/>
		<result property="code_name_kor" column="CD_NM"/>
		<result property="code_name" column="CD_ENG"/>

	</resultMap>

<!-- select -->
	
	<select id="selectCodeListByCondition" resultMap="codeList" parameterClass="com.ksg.domain.Code">
		SELECT
				CD_ID, 
				CD_NM, 
				CD_ENG 
		FROM TB_CODE_H

		<dynamic prepend="where">
			<isNotNull property="code_name_kor" prepend="and">
				CD_NM like '%$code_name_kor$%'
			</isNotNull>
		</dynamic>
	</select>
		
	<select id="selectCodeDetailListByCondition" resultClass="com.ksg.domain.Code" parameterClass="com.ksg.domain.Code">
		SELECT 
				code_field,
				code_name,
				code_type,
				code_name_kor 
		FROM TB_CODE_INFO
		<dynamic prepend="WHERE">
		    
		    <isNotNull property="code_type" prepend="and">
		        code_type=#code_type#
		    </isNotNull>
		    
		    <isNotNull property="code_name" prepend="and">
		        code_name like '%$code_name$%'
		    </isNotNull>
 
		</dynamic>
	</select>	

	
	<select id="selectCodeById" resultMap="codeList">
		SELECT
				CD_ID, 
				CD_NM, 
				CD_ENG 
		FROM TB_CODE_H
		WHERE 	CD_ID=#code_field# 
		
	</select>
	
	
	<select id="selectCodeDetailByKey" resultClass="com.ksg.domain.Code" parameterClass="com.ksg.domain.Code">
		SELECT 
				code_field,
				code_name,
				code_type,
				code_name_kor  
		FROM 	TB_CODE_INFO
		WHERE 	code_field=#code_field# 
		AND 	code_name = #code_name#
	</select>

<!-- insert -->

	<insert id="insertCode" parameterClass="com.ksg.domain.Code">
		insert into TB_CODE_H(
			CD_ID,
			CD_NM,
			CD_ENG
		)values
		(
			#code_field#,
			#code_name_kor#,
			#code_name#
		);
	</insert>
	
	<insert id="insertCodeDetail" parameterClass="com.ksg.domain.Code">
		insert into TB_CODE_INFO(
			code_field,
			code_name,
			code_type,
			code_name_kor
		
		)values
		(
			#code_field#,
			#code_name#,
			#code_type#,
			#code_name_kor#
		);
	</insert>	
	
<!-- update -->
	
	<update id="updateCode" parameterClass="com.ksg.domain.Code">
		update TB_CODE_H 
			set 
				CD_NM=#code_name_kor#
			where 
			(
				CD_ID=#code_field#
			)
	</update>

<!-- delete -->	
	<delete id="deleteCode" >
		DELETE 
		FROM TB_CODE_H 
		WHERE CD_ID=#code_field#
	</delete>
	
	<delete id="deleteCodeDetail" parameterClass="com.ksg.domain.Code">
		DELETE 
		FROM 	TB_CODE_INFO 
		WHERE 	code_field=#code_field# 
		AND 	code_name=#code_name#
	</delete>
	
	
<!-- count -->

	<select id="selectCount" resultClass="int">
		select count(*) from TB_CODE_INFO	
	</select>
	<select id="selectCountH" resultClass="int">
		select count(*) from TB_CODE_H	
	</select>

<!-- ********************************************* -->	


				
</sqlMap>